<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>IELTS Writing AI</title>
</head>
<body>

<h2>IELTS Writing Task Submission</h2>

<select id="taskType">
  <option value="task1">Task 1</option>
  <option value="task2">Task 2</option>
</select>

<br><br>

<textarea id="essay" rows="10" cols="70"
  placeholder="Write your essay here..."></textarea>

<br><br>

<button id="submitBtn">Submit</button>

<p id="status"></p>

<!-- Firebase v9+ (MODULAR) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDf6ei1v5B-WVmgvaBmcdjhQ0GGQlgLeEQ",
    authDomain: "ielts-writing-ai-fff54.firebaseapp.com",
    projectId: "ielts-writing-ai-fff54",
    storageBucket: "ielts-writing-ai-fff54.firebasestorage.app",
    messagingSenderId: "417203345012",
    appId: "1:417203345012:web:27549ffec2baf42a2aa321"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.getElementById("submitBtn").addEventListener("click", async () => {
    const essay = document.getElementById("essay").value;
    const taskType = document.getElementById("taskType").value;

    if (!essay) {
      alert("Essay yozilmadi");
      return;
    }

    try {
      await addDoc(collection(db, "essays"), {
        taskType: taskType,
        content: essay,
        status: "pending",
        createdAt: new Date()
      });

      document.getElementById("status").innerText =
        "Essay yuborildi. Firestore'ga saqlandi.";
      document.getElementById("essay").value = "";

    } catch (error) {
      document.getElementById("status").innerText =
        "Xato: " + error.message;
      console.error(error);
    }
  });
</script>

</body>
</html>
